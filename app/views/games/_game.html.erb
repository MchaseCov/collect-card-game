<div id="animation-data" class="hidden">
  <div class="hidden" id="animationsHidden"></div>
</div>
<aside id="sidebar" class="fixed right-0 z-50 w-1/12 h-full">
  <section id="op-deck" class="absolute flex flex-row gap-x-3 top-5">
    <div class="relative w-40 text-center text-white border-2 border-black rounded h-60 bg-slate-700">
      In Deck:<%=opposing_player_cards[:in_deck]%>
    </div>
  </section>
  <section id="turn-button" class="absolute top-1/2 bottom 1/2">
    <%=game.turn ? "Player 1" : "Player 2" %>'s Turn!<br>
    <% if game.status == "ongoing" %>
      <%=button_to "End Turn",end_turn_game_path(game), disabled: !turn_of?(first_person_player, game), class:"bg-blue-500 text-white font-bold py-2 px-4 rounded disabled:bg-gray-200" %>
    <% end %>
  </section>
  <section id="fp-deck" class="absolute flex flex-row flex-col gap-x-3 flex-nowrap bottom-5">
    <div class="relative w-40 text-center text-white border-2 border-black rounded h-60 bg-slate-700">
      In Deck:<%=first_person_player_cards[:in_deck]%>
    </div>
    <div class="min-w-max">Gold: <%=first_person_player.cost_current%> / <%=first_person_player.cost_cap%></div>
  </section>
</aside>
<article id="main-game-board"
class="flex flex-col h-full flex-nowrap gap-y-6 overflow-clip xl:gap-y-2"
data-controller="gameplay-drag line-drawer style-cards gameboard-animations">
  <canvas id="drawContainer" data-line-drawer-target="canvas" width="0" height="0" class='fixed z-50 pointer-events-none select-none'></canvas>
  <section id="op-info" class="relative w-full h-1/3">
    <section id="op-cards-hand" class="absolute flex-1 w-full ml-auto text-center has-tooltip shrink flex-nowrap whitespace-nowrap -top-16" data-animations-target="hand">
    </section>
  </section>
  <section id="battlefield" class="grid w-full grid-cols-1 grid-rows-2 h-1/3 rounded-2xl" data-animations-target="battlefield">
    <%=render(last_played_card,
         locals: { class: 'absolute left-[15%] bottom-1/2 z-50',
                   id: "animated-card",
                   decorator_data_method: :data_for_last_played} ) if last_played_card  %>
    <%= render 'games/mulligan', first_person_player: first_person_player, game: game if game.status == "mulligan"%>
    <div id="op-cards-battle" class="flex flex-row items-center justify-center w-full">
      <div class="hidden" data-board-id="0"></div>
      <%=render partial: 'party_card_gamestates/in_battle',
         collection: opposing_player_cards[:in_battlefield],
         as: :card,
         locals: { class: 'enemy-card z-30 hover:ring-4 hover:ring-red-300',
                   decorator_data_method: :data_opposing_card_board_battle,
                   draggable: false}%>
    </div>
    <div id="fp-cards-battle" class="flex flex-row items-center justify-center w-full">
      <div class="rounded-full opacity-50 board-space"
        data-board-id="0"
        data-gameplay-drag-target="recievesPlayToBoard"
        data-gameplay-drag-board-target-param="0"
        data-action="drop->gameplay-drag#boardspaceDrop dragenter->gameplay-drag#boardspaceDragEnter dragover->gameplay-drag#dragOver"
        >
      </div>
      <%=render partial: 'party_card_gamestates/in_battle',
         collection: first_person_player_cards[:in_battlefield],
         as: :card,
         locals: { class: 'hover:ring-offset-2 hover:ring-offset-lime-300 board-animatable z-40 ring ring-lime-500 ',
                   decorator_data_method: :data_friendly_card_board_battle,
                   first_person_pov: true,
                   draggable: true }%>
    </div>
  </section>
  <section id="fp-info" class="relative w-full mt-auto h-1/3">
    <div id="fp-cards-hand" class="absolute w-full ml-auto text-center whitespace-nowrap -bottom-32 hover:bottom-0" data-animations-target="hand">
      <%=render first_person_player_cards[:in_hand],
         locals: { game: game,
                   first_person_player: first_person_player,
                   class: 'relative ring ring-lime-500 playing-card inline-block -ml-10 z-10 hover:z-20 hover:bottom-8 hover:scale-125',
                   draggable: true,
                   decorator_data_method: :data_for_hand },
         cached: true %>
    </div>
  </section>
</article>
